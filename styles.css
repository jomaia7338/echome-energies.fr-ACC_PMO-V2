:root{--ink:#1c1c1c;--line:#e6eaea;--muted:#f7f8f8;--ok:#0f766e;--bad:#b91c1c;--brand:#37C3AF}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;color:var(--ink);background:#fff}

.topbar{display:flex;align-items:center;gap:12px;border-bottom:1px solid var(--line);padding:6px 8px}
.brand{display:flex;align-items:center;gap:10px;font-weight:700}
.brand svg{height:26px;width:auto;border-radius:6px;box-shadow:0 0 0 1px rgba(0,0,0,.06)}
.toolbar{display:flex;align-items:center;gap:12px;flex-wrap:wrap;margin-left:auto}
.group{display:flex;align-items:center;gap:8px}
.chip{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border:1px solid var(--line);border-radius:999px;background:#fff}
.dot{width:10px;height:10px;border-radius:50%}
.prod{background:#6D28D9}.cons{background:#2e86de}.poi{background:#E10600}

.btn{padding:6px 8px;border:1px solid var(--brand);border-radius:10px;background:var(--brand);color:#fff;cursor:pointer;font-weight:700}
.btn.icon{min-width:36px;display:inline-flex;align-items:center;justify-content:center}
.btn.secondary{background:#fff;color:#0f4f47;border-color:var(--brand)}
.small{font-size:12px;color:#64748b}

#status{margin:6px 8px 0;border:1px solid var(--line);border-radius:10px;padding:8px;background:#fff;font-size:14px}
#status.ok{background:rgba(55,195,175,.08);border-color:rgba(55,195,175,.45);color:#116a60}
#status.ko{background:#fff5f3;border-color:#f6d2cc}

main{position:relative}
#map{min-height:520px;margin:8px;border:1px solid var(--line);border-radius:12px}
.legend-overlay{position:absolute;bottom:14px;left:14px;background:rgba(255,255,255,.9);border:1px solid var(--line);border-radius:8px;padding:6px 8px;display:flex;gap:10px;align-items:center;font-size:12px;z-index:500}
.legend-overlay .item{display:flex;align-items:center;gap:6px}

#drawer{position:fixed;inset:auto 0 0 auto;top:0;height:100vh;width:420px;max-width:92vw;background:#fff;border-left:1px solid var(--line);box-shadow:-8px 0 24px rgba(0,0,0,.06);transform:translateX(100%);transition:.25s ease;z-index:5000;display:flex;flex-direction:column}
#drawer.open{transform:none}
#drawer header{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--line)}
#drawer .content{padding:12px;overflow:auto}
fieldset{border:1px solid var(--line);border-radius:10px;margin:10px 0;padding:10px}
legend{padding:0 6px;color:#475569;font-size:12px}
textarea, input[type="text"], input[type="number"]{border:1px solid var(--line);border-radius:8px;padding:6px 8px}
.row{display:flex;gap:6px;align-items:center;flex-wrap:wrap}

.tabs{display:flex;gap:6px;padding:8px;border-bottom:1px solid var(--line)}
.tab{border:1px solid var(--line);background:#fff;border-radius:8px;padding:6px 10px;cursor:pointer}
.tab.active{background:#f0faf8;border-color:#9fe6da}
.tab-pane{display:none}
.tab-pane.active{display:block}

.leaflet-control.ratio-control{background:rgba(255,255,255,.95);border:1px solid var(--line);border-radius:8px;padding:4px 8px;font-size:12px;z-index:450}

.print-header{display:none}
@media print{
  @page{size:A4 landscape;margin:12mm}
  .topbar,#drawer,#status,.legend-overlay{display:none!important}
  #map{height:170mm !important; min-height:170mm !important; margin:0; border:0}
  .leaflet-pane, .leaflet-map-pane, .leaflet-tile, .leaflet-marker-icon, .leaflet-marker-shadow{transform:none!important;animation:none!important}
  .leaflet-container{background:#fff!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}
  .leaflet-tile{filter:none!important}
  .print-header{display:flex;align-items:center;justify-content:space-between;margin:0 8px 8px}
  .print-header .brand svg{height:26px}
}